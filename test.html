<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>PDQ-4 Тест</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <main class="container">
    <h1>PDQ-4</h1>
    <p>Ответьте на вопросы «Да» или «Нет»</p>

    <div id="questions"></div>

    <button id="finishButton" class="button">Завершить тест</button>
  </main>

  <script type="module">
    import { calculateResults } from './js/calculateResults.js';
    import questions from './data/questions.json' assert { type: 'json' };

    const container = document.getElementById('questions');

    // Отображаем вопросы
    questions.slice(0, 5).forEach(q => {  // временно только 5 для примера
      const div = document.createElement('div');
      div.className = 'question';
      div.innerHTML = `
        <p>${q.id}. ${q.text}</p>
        <label><input type="radio" name="q${q.id}" value="yes"> Да</label>
        <label><input type="radio" name="q${q.id}" value="no"> Нет</label>
      `;
      container.appendChild(div);
    });

    // Собираем ответы
    function collectAnswers() {
      const answers = {};
      questions.forEach(q => {
        const val = document.querySelector(`input[name="q${q.id}"]:checked`);
        answers[q.id] = val?.value === 'yes';
      });
      return answers;
    }

    // Обработка завершения теста
    document.getElementById('finishButton').addEventListener('click', () => {
      const answers = collectAnswers();
      const results = calculateResults(answers);

      localStorage.setItem('pdqResultsTemp', JSON.stringify(results));
      window.location.href = 'results.html';
    });
  </script>
</body>
</html>
